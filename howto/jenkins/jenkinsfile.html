<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    
    <script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jenkinsfile &mdash; All-My-Notes  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css?v=5c84f910" />
      <link rel="stylesheet" type="text/css" href="../../_static/docsearch.css?v=45fb5152" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=ba2aac58" />
      <link rel="stylesheet" type="text/css" href="../../_static/rtd-docsearch-custom.css?v=726ab6ef" />

  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f0731925"></script>
        <script defer="defer" src="../../_static/docsearch.js?v=77274085"></script>
        <script defer="defer" src="../../_static/docsearch_config.js?v=a08cdb4b"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script src="../../_static/design-tabs.js?v=f930bc37"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js?v=ffc8af2d"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js?v=12818e64"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="next" title="An real-life example Jenkinsfile" href="example_jenkinsfile.html" />
    <link rel="prev" title="Jenkins" href="index.html" /> 
</head>

<body class="wy-body-for-nav">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/symbola" type="text/css"/>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a><div id="docsearch"></div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/cpp/index.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/java/index.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/shell_scripting/index.html">Shell Scripting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-To</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../firefox/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../games/index.html">Games</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Jenkins</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Jenkinsfile</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#disable-trace-messages-some-command-on-console-output">Disable trace messages (”+ some_command”) on console output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-current-status-of-the-pipeline">Check current status of the pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="#print-all-currently-set-environmental-variables">Print all currently set environmental variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-time-trigger-as-conditional">Use time trigger as conditional</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example_jenkinsfile.html">An real-life example Jenkinsfile</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../macos/index.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../others/index.html">Others</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell_scripting/index.html">Shell Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software_design/index.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sphinx/index.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/coding_fonts.html">Coding fonts </a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/conda_commands.html">conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/git/index.html">git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/kubernetes.html">Kubectl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/logitech_k860.html">Logitech K860 - Special keys </a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/others/index.html">Others</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/pycharm/index.html">Pycharm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/rst_sphinx.html">reStructuredText &amp; Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/shell_scripting.html">Shell Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/sqlite/index.html">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/vscode_extensions.html">Visual Studio Code extensions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">All-My-Notes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Jenkins</a></li>
      <li class="breadcrumb-item active">Jenkinsfile</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/howto/jenkins/jenkinsfile.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="jenkinsfile">
<h1>Jenkinsfile<a class="headerlink" href="#jenkinsfile" title="Link to this heading"></a></h1>
<section id="disable-trace-messages-some-command-on-console-output">
<h2>Disable trace messages (”+ some_command”) on console output<a class="headerlink" href="#disable-trace-messages-some-command-on-console-output" title="Link to this heading"></a></h2>
<dl class="field-list">
<dt class="field-odd">Issue<span class="colon">:</span></dt>
<dd class="field-odd"><p>When adding <em>echo</em> shell commands in a Jenkinsfile, like</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">script</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        echo &quot;Hello world&quot;</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>it causes the line to be printed twice, once as a execution trace messages,
and once as the original <em>echo</em> command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+ echo Hello world
Hello world
</pre></div>
</div>
<p>whereas we only want to second line to be shown.</p>
</dd>
<dt class="field-even">Cause<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://www.jenkins.io/doc/pipeline/steps/workflow-durable-task-step/#sh-shell-script">By default</a>, Jenkins launches shell commands with the <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">-x</span></code> option (see
<a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html">here</a> for more info), which causes all commands to be echoed.
For most commands defined inside the Jenkinsfile, that selection makes sense
in order to know which command triggered the proceeding console output, but
for echo it’s merely a repetition.</p>
</dd>
<dt class="field-odd">Solution<span class="colon">:</span></dt>
<dd class="field-odd"><p>Deactivate the trace printing by setting <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">+x</span></code> (the “+” switches off
the option), before executing the <em>echo</em> command. In case different commands
follow in the same shell code block, re-activate it:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">script</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        # ### Deactivate tracing</span>
<span class="s1">        { set +x; } 2&gt;/dev/null</span>
<span class="s1">        echo &quot;Hello world&quot;</span>
<span class="s1">        # ### Re-activate tracing</span>
<span class="s1">        { set -x; } 2&gt;/dev/null</span>
<span class="s1">        cp some_file /some/dir/</span>
<span class="s1">    &#39;&#39;&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This shows the following console output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Hello world
+ cp some_file /some/dir
</pre></div>
</div>
<p>In order to not show the <em>set</em> commands in the output, put them into curly
braces assigning their <em>stderr</em> output to <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nb">set</span> <span class="o">+</span><span class="n">x</span><span class="p">;</span> <span class="p">}</span> <span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
</dd>
</dl>
</section>
<section id="check-current-status-of-the-pipeline">
<h2>Check current status of the pipeline<a class="headerlink" href="#check-current-status-of-the-pipeline" title="Link to this heading"></a></h2>
<p>In order to check the current status of the pipeline within or in-between stages,
use the following statement:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">stage</span><span class="o">(</span><span class="s2">&quot;Do something&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">steps</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;currentBuild.currentResult: ${currentBuild.currentResult}&quot;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You can also use the status as a conditional for execution of a stage:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">stage</span><span class="o">(</span><span class="s1">&#39;Do something if pipeline so far OK&#39;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">when</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="n">expression</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="n">currentBuild</span><span class="o">.</span><span class="na">currentResult</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SUCCESS&#39;</span><span class="w"> </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="n">steps</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="c1">// do something</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">currentBuild.result</span></code> returns <code class="docutils literal notranslate"><span class="pre">null</span></code> if used inside the <a class="reference external" href="https://www.jenkins.io/doc/book/pipeline/syntax/#stages">stages</a>
section, but returns the status if used inside the <a class="reference external" href="https://www.jenkins.io/doc/book/pipeline/syntax/#post">post</a> section.</p>
</div>
</section>
<section id="print-all-currently-set-environmental-variables">
<h2>Print all currently set environmental variables<a class="headerlink" href="#print-all-currently-set-environmental-variables" title="Link to this heading"></a></h2>
<p>In order to see all currently available environmental variables, add this line to the
respective Jenkinsfile position:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">script</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">sh</span><span class="w"> </span><span class="s1">&#39;printenv&#39;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>which will output them in the following manner:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>10:19:18  GIT_USERNAME=****
10:19:18  JENKINS_HOME=/var/jenkins_home
10:19:18  GIT_COMMITTER_NAME=tts jenkins
10:19:18  GIT_PREVIOUS_SUCCESSFUL_COMMIT=de8bcce7ba3662eb36dc36d2d822cb3aa9adf3fb
10:19:18  MAIL=/var/mail/jenkins
10:19:18  LC_TIME=de_DE.UTF-8
...
</pre></div>
</div>
<p>Each of these variables can be accessed via ${ENVIRONMENT_NAME}, for example:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">script</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">echo</span><span class="w"> </span><span class="n">$GIT_COMMITTER_NAME</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="use-time-trigger-as-conditional">
<h2>Use time trigger as conditional<a class="headerlink" href="#use-time-trigger-as-conditional" title="Link to this heading"></a></h2>
<p>In case a certain step is only supposed to happen if a build was started via a
time trigger, there is a conditional step, you can use:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="n">env</span><span class="o">.</span><span class="na">BUILD_USER</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Timer Trigger&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="c1">// do something</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Jenkins" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example_jenkinsfile.html" class="btn btn-neutral float-right" title="An real-life example Jenkinsfile" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
      <div class="lastupdate">
        This page was last updated on
        <span class="update_date">Aug 21, 2024</span>.
      </div>
    
    <p>&#169; Copyright 2021-2024, Arne Wohletz.</p>

  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>