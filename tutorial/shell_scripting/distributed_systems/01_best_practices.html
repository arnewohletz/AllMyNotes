

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    
    <script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Best practices &mdash; All-My-Notes  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.min.css?v=6e7d0de0" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/pointer.css?v=c97663ff" />
      <link rel="stylesheet" type="text/css" href="../../../_static/docsearch.css?v=0bd54598" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=ba2aac58" />
      <link rel="stylesheet" type="text/css" href="../../../_static/rtd-docsearch-custom.css?v=726ab6ef" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/thebelab-helper.js"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f0731925"></script>
      <script defer="defer" src="../../../_static/docsearch.js?v=711ed680"></script>
      <script defer="defer" src="../../../_static/docsearch_config.js?v=a08cdb4b"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js?v=f0ca4bb6"></script>
      <script src="../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js?v=12818e64"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="next" title="Code Reusability" href="02_reusability.html" />
    <link rel="prev" title="Distributed Systems - A Bash Tutorial" href="index.html" /> 
</head>

<body class="wy-body-for-nav">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/symbola" type="text/css"/>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a><div id="docsearch"></div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cpp/index.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java/index.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java_script/alfatraining/index.html">JavaScript (alfatraining)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Python</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Shell Scripting</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Distributed Systems - A Bash Tutorial</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Best practices </a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prevent-code-injection">Prevent code injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-functions">Use functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mind-variable-scopes">Mind variable scopes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#properly-name-function-arguments">Properly name function arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#always-separate-declaration-and-assignment-of-variables">Always separate declaration and assignment of variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="02_reusability.html">Code Reusability </a></li>
<li class="toctree-l3"><a class="reference internal" href="03_unit_testing.html">Unit testing </a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cronjobs.html">Linux: Manage scripts via cron job</a></li>
<li class="toctree-l2"><a class="reference internal" href="../macos_zsh_basic.html">macOS: zsh and launchd</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-To</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/firefox/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/games/index.html">Games</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/macos/index.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/others/index.html">Others</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/shell_scripting/index.html">Shell Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/software_design/index.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/sphinx/index.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto/windows/index.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/coding_fonts.html">Coding fonts </a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/conda_commands.html">conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/git/index.html">git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/kubernetes.html">Kubectl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/logitech_k860.html">Logitech K860 - Special keys </a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/others/index.html">Others</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/pycharm/index.html">Pycharm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/rst_sphinx.html">reStructuredText &amp; Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/shell_scripting.html">Shell Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/sqlite/index.html">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/vs_code/index.html">VS Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">All-My-Notes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Shell Scripting</a></li>
          <li class="breadcrumb-item"><a href="index.html">Distributed Systems - A Bash Tutorial</a></li>
      <li class="breadcrumb-item active">Best practices </li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tutorial/shell_scripting/distributed_systems/01_best_practices.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="best-practices">
<h1>Best practices <a class="footnote-reference brackets" href="#footcite-kruk22-muschelperlen" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a><a class="headerlink" href="#best-practices" title="Link to this heading"></a></h1>
<section id="prevent-code-injection">
<h2>Prevent code injection<a class="headerlink" href="#prevent-code-injection" title="Link to this heading"></a></h2>
<p>In comparison to Python, Bash scripts are already executed while reading them.
This makes it impossible to change them at runtime. This example demonstrates
a resulting problem:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="ch">#!/bin/bash</span>
<span class="linenos">2</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This row is only printed once&quot;</span>
<span class="linenos">3</span><span class="nv">padded</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;%*s&#39;</span><span class="w"> </span><span class="m">256</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cat<span class="w"> </span>-<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$0</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="linenos">4</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$padded</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$0</span><span class="s2">&quot;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">line 3<span class="colon">:</span></dt>
<dd class="field-odd"><p>printf defines a minimum amount of characters to print (256), in this case
using a wildcard (<code class="docutils literal notranslate"><span class="pre">%*s</span></code>) and passing in spaces (’ ‘). The result is then piped
into <code class="docutils literal notranslate"><span class="pre">cat</span></code>, which concatenates the result AKA standard input (meaning of <code class="docutils literal notranslate"><span class="pre">-</span></code>,
and the contents of the file (<code class="docutils literal notranslate"><span class="pre">&quot;$0&quot;</span></code>). The result is assigned to the <code class="docutils literal notranslate"><span class="pre">padded</span></code>
variable.</p>
</dd>
<dt class="field-even">line 4<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of padded content (line 3) overwrites the script file</p>
</dd>
</dl>
<p>Bash scripts are read character by character, bash remembers the current position via
an index. When everything is pushed to a higher index position because of the
proceeding spaces, the current position which bash remembers to be is then not
the same position in the actual script. Because of that, the
bash executes the remaining lines over and over again, resulting in an endless script.</p>
<p>This is a security issue, known as <em>code injection</em>, which attackers can use the manipulate
important scripts, for instance in order to gain access rights.</p>
<p>To prevent code injection, put the entire script into a <em>command group</em>, which is
then read into the memory all at once:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="ch">#!/bin/bash</span>
<span class="linenos">2</span><span class="o">{</span>
<span class="linenos">3</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This row is only printed once&quot;</span>
<span class="linenos">4</span><span class="w">  </span><span class="nv">padded</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;%*s&#39;</span><span class="w"> </span><span class="m">256</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cat<span class="w"> </span>-<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$0</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="linenos">5</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$padded</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$0</span><span class="s2">&quot;</span>
<span class="linenos">6</span><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">7</span><span class="o">}</span>
</pre></div>
</div>
<p>The <code class="code highlight bash docutils literal highlight-bash"><span class="nb">exit</span><span class="w"> </span><span class="m">0</span></code> at the end guarantees that the script is ended at the end of the
group. Otherwise an attacker could still append content, which is then executed after
the group finishes.</p>
<p>Running script instances cannot be altered, but to prevent any changes to the script
on the files system, prevent other users from editing the file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>/path/to/script.sh
</pre></div>
</div>
</section>
<section id="use-functions">
<h2>Use functions<a class="headerlink" href="#use-functions" title="Link to this heading"></a></h2>
<p>Functions are also read in one go, so another possibility is to use a <em>main</em> function,
which is called by a short command group. A basic structure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="ch">#!/bin/bash</span>
<span class="linenos">2</span>main<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">3</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">4</span><span class="o">}</span>
<span class="linenos">5</span><span class="o">{</span>
<span class="linenos">6</span><span class="w">  </span>main<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="linenos">7</span><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$?</span><span class="s2">&quot;</span>
<span class="linenos">8</span><span class="o">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">line 6<span class="colon">:</span></dt>
<dd class="field-odd"><p>The <em>main</em> function is called passing all script arguments (<code class="code highlight bash docutils literal highlight-bash"><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span></code>
stands for “$1” “$2” … and so on). See <a class="reference external" href="https://tiswww.case.edu/php/chet/bash/bashref.html#Special-Parameters">bash manual</a> for more.</p>
</dd>
<dt class="field-even">line 7<span class="colon">:</span></dt>
<dd class="field-even"><p>Script exits with the exit status of the most recently executed foreground
pipeline (here: 0 from main()).</p>
</dd>
</dl>
</section>
<section id="mind-variable-scopes">
<h2>Mind variable scopes<a class="headerlink" href="#mind-variable-scopes" title="Link to this heading"></a></h2>
<p>Functions have the advantage of being able to declare local variables.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All variables that are not declared via <code class="code highlight bash docutils literal highlight-bash"><span class="nb">local</span></code> or <code class="code highlight bash docutils literal highlight-bash"><span class="nb">declare</span></code>
(without <code class="code highlight bash docutils literal highlight-bash">-g</code> option) function as global variables.</p>
</div>
<ul class="simple">
<li><p>Variables passed into functions inherit the scope of the callee</p></li>
<li><p>Global variables can be replaced by equally named local variable</p></li>
<li><p>If a local variable, declared by the callee, is changed within the function, it
was passed into, the variable of the callee is changed as well</p></li>
</ul>
<p>Demonstration:</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#!/bin/bash</span>
<span class="linenos"> 2</span>servus_local<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos"> 3</span><span class="w">  </span><span class="nv">local_gruss</span><span class="o">=</span><span class="s2">&quot;Servus&quot;</span>
<span class="linenos"> 4</span><span class="w">  </span>moin_local
<span class="linenos"> 5</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos"> 6</span><span class="o">}</span>
<span class="linenos"> 7</span>moin_local<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="nv">local_gruss</span><span class="o">=</span><span class="s2">&quot;Moin&quot;</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">10</span><span class="o">}</span>
<span class="linenos">11</span>servus_dynamic<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">12</span><span class="w">  </span><span class="nv">local_gruss</span><span class="o">=</span><span class="s2">&quot;Servus&quot;</span>
<span class="linenos">13</span><span class="w">  </span>moin_dynamic
<span class="linenos">14</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">15</span><span class="o">}</span>
<span class="linenos">16</span>moin_dynamic<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">17</span><span class="w">  </span><span class="nv">gruss</span><span class="o">=</span><span class="s2">&quot;Moin&quot;</span>
<span class="linenos">18</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">19</span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">20</span>servus_global<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">21</span><span class="w">  </span><span class="nv">gruss</span><span class="o">=</span><span class="s2">&quot;Servus&quot;</span>
<span class="linenos">22</span><span class="w">  </span>moin_global
<span class="linenos">23</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">24</span><span class="o">}</span>
<span class="linenos">25</span>moin_global<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">26</span><span class="w">  </span><span class="nv">gruss</span><span class="o">=</span><span class="s2">&quot;Moin&quot;</span>
<span class="linenos">27</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">28</span><span class="o">}</span>
<span class="linenos">29</span>main<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos">30</span><span class="w">  </span>servus_local
<span class="linenos">31</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">32</span><span class="w">  </span>servus_dynamic
<span class="linenos">33</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">34</span><span class="w">  </span>servus_global
<span class="linenos">35</span><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$FUNCNAME</span><span class="s2">] </span><span class="nv">$gruss</span><span class="s2"> </span><span class="nv">$USER</span><span class="s2">&quot;</span>
<span class="linenos">36</span><span class="o">}</span>
<span class="linenos">37</span><span class="o">{</span>
<span class="linenos">38</span><span class="w">  </span>main<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="linenos">39</span><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$?</span><span class="s2">&quot;</span>
<span class="linenos">40</span><span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>which outputs (for $USER=”arnewohletz”):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[moin_local] Moin arnewohletz
[servus_local] Servus arnewohletz
[main]  arnewohletz
[moin_dynamic] Moin arnewohletz
[servus_dynamic] Moin arnewohletz
[main]  arnewohletz
[moin_global] Moin arnewohletz
[servus_global] Moin arnewohletz
[main] Moin arnewohletz
</pre></div>
</div>
<p>Always declare your variables with <code class="code highlight bash docutils literal highlight-bash"><span class="nb">local</span></code> and <code class="code highlight bash docutils literal highlight-bash"><span class="nb">declare</span></code> (see
<a class="reference external" href="https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html">built-in commands</a>).</p>
<p>To enable warning messages for undeclared variables, run your script via the
<code class="code highlight bash docutils literal highlight-bash">-u</code> option. You may also check your script using the <a class="reference external" href="https://www.shellcheck.net/">ShellCheck</a>.</p>
</section>
<section id="properly-name-function-arguments">
<h2>Properly name function arguments<a class="headerlink" href="#properly-name-function-arguments" title="Link to this heading"></a></h2>
<p>In Bash, function don’t have arguments but positional parameters, which are numbered,
but don’t have names. When a method uses more than five or more arguments, it is hard
to keep track of the position for each of them.</p>
<p>To overcome this issue, declare all positional parameter as local variable at the
beginning of each function:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>send_email<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">address</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">message</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$3</span><span class="s2">&quot;</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="always-separate-declaration-and-assignment-of-variables">
<h2>Always separate declaration and assignment of variables<a class="headerlink" href="#always-separate-declaration-and-assignment-of-variables" title="Link to this heading"></a></h2>
<p>Be careful not to declare and assign a variable in one line: both actions are
executed sequentially and not in a defined order. For direct assignments, this is
not critical, but it is when the assigned value comes from a subshell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>file_contains<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="linenos"> 2</span><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">file</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="linenos"> 3</span><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">search_pattern</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="linenos"> 4</span><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">result</span><span class="o">=</span><span class="k">$(</span>grep<span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$search_patern</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$file</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="linenos"> 5</span><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="c1"># nothing found</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="k">fi</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="m">0</span>
<span class="linenos">10</span><span class="o">}</span>
</pre></div>
</div>
<p>In line 5, the <em>$?</em> variable, the return value of tha previous command (line 4)
does not receive the <em>grep</em> return value, but the one from <em>local</em>, which is
always 0 except if the command received illegal parameters.</p>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-kruk22-muschelperlen" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Matthias Kruk. Muschelperlen. <em>Linux-Magazin</em>, 06/2022:76–79, 2022.</p>
</aside>
</aside>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Distributed Systems - A Bash Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="02_reusability.html" class="btn btn-neutral float-right" title="Code Reusability" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
      <div class="lastupdate">
        This page was last updated on
        <span class="update_date">Aug 15, 2025</span>.
      </div>
    
    <p>&#169; Copyright 2021-2025, Arne Wohletz.</p>

  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>