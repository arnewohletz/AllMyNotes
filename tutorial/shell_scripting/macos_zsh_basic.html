

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    
    <script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>macOS: zsh and launchd &mdash; All-My-Notes  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.min.css?v=6e7d0de0" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/pointer.css?v=c97663ff" />
      <link rel="stylesheet" type="text/css" href="../../_static/docsearch.css?v=0bd54598" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=ba2aac58" />
      <link rel="stylesheet" type="text/css" href="../../_static/rtd-docsearch-custom.css?v=726ab6ef" />

  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/thebelab-helper.js"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f0731925"></script>
      <script defer="defer" src="../../_static/docsearch.js?v=711ed680"></script>
      <script defer="defer" src="../../_static/docsearch_config.js?v=a08cdb4b"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js?v=f0ca4bb6"></script>
      <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js?v=12818e64"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="next" title="Docker" href="../../howto/docker/index.html" />
    <link rel="prev" title="Linux: Manage scripts via cron job" href="cronjobs.html" /> 
</head>

<body class="wy-body-for-nav">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/symbola" type="text/css"/>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a><div id="docsearch"></div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cpp/index.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java/index.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java_script/alfatraining/index.html">JavaScript (alfatraining)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Shell Scripting</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="distributed_systems/index.html">Distributed Systems - A Bash Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="cronjobs.html">Linux: Manage scripts via cron job</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">macOS: zsh and launchd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-basic-shell-script">A basic shell script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launchd-script-management">launchd: Script management</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-To</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../howto/docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/firefox/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/games/index.html">Games</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/macos/index.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/others/index.html">Others</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/shell_scripting/index.html">Shell Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/software_design/index.html">Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/sphinx/index.html">Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/windows/index.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/coding_fonts.html">Coding fonts </a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/conda_commands.html">conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/git/index.html">git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/kubernetes.html">Kubectl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/logitech_k860.html">Logitech K860 - Special keys </a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/network/index.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/others/index.html">Others</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/pycharm/index.html">Pycharm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/rst_sphinx.html">reStructuredText &amp; Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/shell_scripting.html">Shell Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/sqlite/index.html">SQLite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/vs_code/index.html">VS Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">All-My-Notes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Shell Scripting</a></li>
      <li class="breadcrumb-item active">macOS: zsh and launchd</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorial/shell_scripting/macos_zsh_basic.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="macos-zsh-and-launchd">
<h1>macOS: zsh and launchd<a class="headerlink" href="#macos-zsh-and-launchd" title="Link to this heading"></a></h1>
<p>As of version 10.15 (Catalina) macOS changed the default shell to <a class="reference external" href="https://www.zsh.org/">zsh</a> (Z Shell), prior
using <a class="reference external" href="https://www.gnu.org/software/bash/">bash</a> (Bourne again Shell). While <em>bash</em> is still available in macOS as of now, it
is recommended to zsh, including for shell scripts.</p>
<section id="a-basic-shell-script">
<h2>A basic shell script<a class="headerlink" href="#a-basic-shell-script" title="Link to this heading"></a></h2>
<p>Shell scripts use the *.sh suffix. In order to execute shell scripts directly, like</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>my_first_script.sh
</pre></div>
</div>
<p>instead of requiring to pass it as an argument to a shell call like</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>zsh<span class="w"> </span>./my_first_script.sh
</pre></div>
</div>
<p>a so called <a class="reference external" href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> line is required in your script as the first line. This declares
which type of shell is used when the script is called directly. It is recommended to
use this shebang line on macOS:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="ch">#!/usr/bin/env zsh -l</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> tool acts as a pointer towards the shell binary file.
Using it makes the script less system dependent. Passing in the <code class="docutils literal notranslate"><span class="pre">zsh</span></code> argument
defines, that we want the path to the zsh shell (here <code class="docutils literal notranslate"><span class="pre">/bin/zsh</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-l</span></code> option defines, that we want a shell with the current user being logged
into it. This executes the user specific profile files like <code class="docutils literal notranslate"><span class="pre">/etc/zprofile</span></code> or
<code class="docutils literal notranslate"><span class="pre">~/.zshrc</span></code> (<a class="reference external" href="https://scriptingosx.com/2019/06/moving-to-zsh-part-2-configuration-files/">more info</a>), which feed to the PATH variable, which otherwise contains
no paths to user-specific executable directories, such as <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code>. In the
shell script this enables us to use commands directly, without having to use their
absolute paths:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># use binary commands directly</span>
<span class="nv">match</span><span class="o">=</span><span class="k">$(</span>pcregrep<span class="w"> </span>-o1<span class="w"> </span><span class="nv">$update_version_regex</span><span class="w"> </span><span class="nv">$tmp_file</span><span class="k">)</span>
say<span class="w"> </span><span class="s2">&quot;This worked just fine&quot;</span>

<span class="c1"># instead of requiring its absolute path</span>
<span class="nv">match</span><span class="o">=</span><span class="k">$(</span>/usr/local/bin/pcregrep<span class="w"> </span>-o1<span class="w"> </span><span class="nv">$update_version_regex</span><span class="w"> </span><span class="nv">$tmp_file</span><span class="k">)</span>
/usr/bin/say<span class="w"> </span><span class="s2">&quot;This worked as well, but is longer and system dependent&quot;</span>
</pre></div>
</div>
<p>macOS uses a tool called <em>path_helper</em> to feed some entries to the PATH variable.
It is called from <code class="docutils literal notranslate"><span class="pre">/etc/zprofile</span></code> by default.</p>
</div>
<p>Next up you may define your shell script. Here are some useful resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://scriptingosx.com/">https://scriptingosx.com/</a></p></li>
<li><p><a class="reference external" href="https://www.gnu.org/software/bash/manual/bash.html">https://www.gnu.org/software/bash/manual/bash.html</a></p></li>
<li><p><a class="reference external" href="https://zsh.sourceforge.io/Doc/Release/zsh_toc.html">https://zsh.sourceforge.io/Doc/Release/zsh_toc.html</a></p></li>
</ul>
<p>Make sure to make your script executable (for security reasons this is not done by default):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>my_first_script.sh
</pre></div>
</div>
</section>
<section id="launchd-script-management">
<h2>launchd: Script management<a class="headerlink" href="#launchd-script-management" title="Link to this heading"></a></h2>
<p>If you created a script and wish to execute regularly or on specific occasion (e.g.
after each log-in), macOS provides the <a class="reference external" href="https://www.launchd.info/">launchd</a> tool, which manages services and daemons,
similar to Linux’ <em>systemd</em>. Similar to <em>cron</em> on Linux (or the <em>Task Scheduler</em> on Windows)
it offers the possibility to schedule executions of shell scripts.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>There are tools which help generating *.plist files (although you might still
need to do some manual tweaking afterwards), such as:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.soma-zone.com/LaunchControl/">LaunchControl</a> (proprietary, needs license)</p></li>
<li><p><a class="reference external" href="https://launched.zerowidth.com/">https://launched.zerowidth.com/</a> (web form -&gt; save as *.plist, not *.xml)</p></li>
</ul>
</div>
<p>Launchd tasks (agents and daemons) are defined in *.plist config files, which follows the
XML syntax. For our script we create a new file in <code class="docutils literal notranslate"><span class="pre">~/Library/LaunchAgents</span></code> (the user
agent directory):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>touch<span class="w"> </span>~/Library/LaunchAgents/my_first_script.plist
</pre></div>
</div>
<p>Add in the following content:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="linenos"> 2</span><span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span>
<span class="linenos"> 3</span><span class="nt">&lt;plist</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="nt">&lt;dict&gt;</span>
<span class="linenos"> 5</span><span class="w">        </span><span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
<span class="linenos"> 6</span><span class="w">        </span><span class="nt">&lt;string&gt;</span>MY_SCRIPT_NAME<span class="nt">&lt;/string&gt;</span>
<span class="linenos"> 7</span><span class="w">        </span><span class="nt">&lt;key&gt;</span>ProgramArguments<span class="nt">&lt;/key&gt;</span>
<span class="linenos"> 8</span><span class="w">        </span><span class="nt">&lt;array&gt;</span>
<span class="linenos"> 9</span><span class="w">            </span><span class="nt">&lt;string&gt;</span>/bin/zsh<span class="nt">&lt;/string&gt;</span>
<span class="linenos">10</span><span class="w">            </span><span class="nt">&lt;string&gt;</span>-c<span class="nt">&lt;/string&gt;</span>
<span class="linenos">11</span><span class="w">            </span><span class="nt">&lt;string&gt;</span>/PATH/TO/MY/SCRIPT.sh<span class="nt">&lt;/string&gt;</span>
<span class="linenos">12</span><span class="w">        </span><span class="nt">&lt;/array&gt;</span>
<span class="linenos">13</span><span class="w">        </span><span class="nt">&lt;key&gt;</span>StartInterval<span class="nt">&lt;/key&gt;</span>
<span class="linenos">14</span><span class="w">        </span><span class="nt">&lt;integer&gt;</span>3600<span class="nt">&lt;/integer&gt;</span>
<span class="linenos">15</span><span class="w">        </span><span class="nt">&lt;key&gt;</span>StandardOutPath<span class="nt">&lt;/key&gt;</span>
<span class="linenos">16</span><span class="w">        </span><span class="nt">&lt;string&gt;</span>~/tmp/MY_SCRIPT_NAME.stdout.log<span class="nt">&lt;/string&gt;</span>
<span class="linenos">17</span><span class="w">        </span><span class="nt">&lt;key&gt;</span>StandardErrorPath<span class="nt">&lt;/key&gt;</span>
<span class="linenos">18</span><span class="w">        </span><span class="nt">&lt;string&gt;</span>~/tmp/MY_SCRIPT_NAME.stderr.log<span class="nt">&lt;/string&gt;</span>
<span class="linenos">19</span><span class="w">        </span><span class="nt">&lt;key&gt;</span>AbandonProcessGroup<span class="nt">&lt;/key&gt;</span>
<span class="linenos">20</span><span class="w">        </span><span class="nt">&lt;true/&gt;</span>
<span class="linenos">21</span><span class="w">    </span><span class="nt">&lt;/dict&gt;</span>
<span class="linenos">22</span><span class="nt">&lt;/plist&gt;</span>
</pre></div>
</div>
<p>Now go ahead and replace MY_SCRIPT_NAME and PATH/TO/MY/SCRIPT.sh to match your script. Also edit the
<em>StartInterval</em> time if needed (above set to 3600 seconds, which is one execution per hour).
To run the script only once on login replace</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="linenos">13</span><span class="nt">&lt;key&gt;</span>StartInterval<span class="nt">&lt;/key&gt;</span>
<span class="linenos">14</span><span class="nt">&lt;integer&gt;</span>3600<span class="nt">&lt;/integer&gt;</span>
</pre></div>
</div>
<p>with</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="linenos">13</span><span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span>
<span class="linenos">14</span><span class="nt">&lt;true/&gt;</span>
</pre></div>
</div>
<p>For more information on the plist options, check <a class="reference external" href="https://www.launchd.info/">https://www.launchd.info/</a>.</p>
<p>After you finished configuration file, add it to the <em>launchd</em> controller:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>launchctl<span class="w"> </span>load<span class="w"> </span>~/Library/LaunchAgents/my_first_script.plist
</pre></div>
</div>
<p>To check the status of the last execution run (replace MY_SCRIPT_NAME with the label
you defined in your *.plist file)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>launchctl<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>MY_SCRIPT_NAME
</pre></div>
</div>
<p>which lists the return code of your script from the last execution, which should be 0,
if the script ran successfully. Check the <em>stderr.log</em> and <em>stdout.log</em> files which
you defined in the *.plist config file for clues.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The return code is always 0 before the script was executed once after loading it.
For debugging, change to a low <em>StartInterval</em> value to trigger an execution.</p>
</div>
<p>To remove the script from the launcher run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>launchctl<span class="w"> </span>unload<span class="w"> </span>~/Library/LaunchAgents/my_first_script.plist
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Changes to the shell script are adapted and used at the next execution, but changes
to the *.plist require a reload (<em>unload</em> then again <em>load</em>) to the launch controller.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cronjobs.html" class="btn btn-neutral float-left" title="Linux: Manage scripts via cron job" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../howto/docker/index.html" class="btn btn-neutral float-right" title="Docker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
      <div class="lastupdate">
        This page was last updated on
        <span class="update_date">Aug 15, 2025</span>.
      </div>
    
    <p>&#169; Copyright 2021-2025, Arne Wohletz.</p>

  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>